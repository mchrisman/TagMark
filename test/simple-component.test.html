<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simple Component Test</title>
  <script src="../lib/deep_proxy.js"></script>
  <script src="../lib/ActDown.js"></script>
  <script src="../lib/ActDown-ext-forms.js"></script>
  <script src="../src/tagmark.js"></script>
  <script src="./_harness.js"></script>
</head>
<body>
<tag-mark id="root">
  <Counter:Template init="{ {count: 0} }">
    <div class="counter">
      <span class="count">{@Counter.count}</span>
      <button class="inc" onclick="@{ @Counter.count++ }">+</button>
    </div>
  </Counter:Template>

  <Counter></Counter>
</tag-mark>

<div id="test-results" data-status="pending"></div>

<script>
const nextTick = () => new Promise(r => setTimeout(r));

Test.run("simple-component", t => {
  TagMark.ready(async () => {
    const count = document.querySelector(".count");
    t.ok(count, "Counter rendered");
    t.eq(count?.textContent, "0", "Template init sets count to 0");

    document.querySelector(".inc")?.click();
    await nextTick();
    t.eq(count?.textContent, "1", "Click incremented count");

    t.done();
  });
});
</script>
</body>
</html>
