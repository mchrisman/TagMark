<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Test: Slots with fallback</title>
  <script src="../lib/deep_proxy.js"></script>
  <script src="../lib/ActDown.js"></script>
  <script src="../lib/ActDown-ext-forms.js"></script>
  <script src="../src/tagmark.js"></script>
  <script src="./_harness.js"></script>
</head>
<body>

<h1>Slotting and Fallback</h1>

<tag-mark id="root">
  <Card:Template>
    <div class="card">
      <header class="card-header"><Header:Slot>Default Header</Header:Slot></header>
      <section class="card-body"><Card:Slot>Default Body</Card:Slot></section>
    </div>
  </Card:Template>

  <section class="examples">
    <Card class="custom">
      <Header>Custom Header</Header>
      Custom Body
    </Card>

    <Card class="fallback"></Card>
  </section>
</tag-mark>

<div id="test-results" data-status="pending"></div>

<script>
Test.run("slotting-and-fallback", t => {
  if (!window.TagMark || typeof TagMark.ready !== "function") {
    t.fail("TagMark not available");
    t.done();
    return;
  }

  TagMark.ready(() => {
    const customHeader = document.querySelector(".custom .card-header")?.textContent.trim();
    const customBody = document.querySelector(".custom .card-body")?.textContent.trim();
    const fallbackHeader = document.querySelector(".fallback .card-header")?.textContent.trim();
    const fallbackBody = document.querySelector(".fallback .card-body")?.textContent.trim();

    t.eq(customHeader, "Custom Header", "named slot receives provided content");
    t.eq(customBody, "Custom Body", "default slot receives children");
    t.eq(fallbackHeader, "Default Header", "fallback header renders when missing");
    t.eq(fallbackBody, "Default Body", "fallback body renders when missing");
    t.done();
  });
});
</script>

</body>
</html>
